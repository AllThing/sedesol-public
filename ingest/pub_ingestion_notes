This document describes the steps we carried out to convert the PUB oracle dmps
to .csv files that can then be ingested into our database. We knocked out the
columns that are either always NULL or '0', and then exported the remanining
interesting columns to a .csv.

------
STEP 1
------
describe TU_BORRA_EXPORT_160610_S072;
describe TU_BORRA_EXPORT_160610_PUB;


 Name					   Null?    Type
 ----------------------------------------- -------- ----------------------------
 CVE_PAD					    CHAR(4)
 PERIODO					    CHAR(7)
 ID_REGISTRO					    VARCHAR2(40)
 ID_HOGAR					    VARCHAR2(30)
 ID_CUIS_PS					    VARCHAR2(40)
 ID_CUIS_SEDESOL				    VARCHAR2(40)
 FH_LEVANTAMIENTO				    DATE
 ID_PERSONA					    VARCHAR2(40)
 NB_PRIMER_AP					    VARCHAR2(50)
 NB_SEGUNDO_AP					    VARCHAR2(50)
 NB_NOMBRE					    VARCHAR2(50)
 FH_NACIMIENTO					    DATE
 CD_SEXO					    VARCHAR2(1)
 CD_EDO_NAC					    NUMBER(2)
 NB_CURP_ORI					    VARCHAR2(18)
 IN_HUELLA					    VARCHAR2(1)
 IN_IRIS					    VARCHAR2(1)
 CD_EDO_CIVIL					    NUMBER(2)
 CD_DEPENDENCIA 				    NUMBER(2)
 CD_INSTITUCION 				    VARCHAR2(5)
 CD_PROGRAMA					    VARCHAR2(4)
 CD_INTRAPROGRAMA				    NUMBER(2)
 NB_SUBPROGRAMA 				    VARCHAR2(60)
 CD_ENT_PAGO					    VARCHAR2(2)
 CD_MUN_PAGO					    VARCHAR2(3)
 CD_LOC_PAGO					    VARCHAR2(4)
 CD_TP_BENEFICIO				    NUMBER(3)
 IN_TITULAR					    NUMBER(1)
 CD_PARENTESCO					    NUMBER(2)
 CD_TP_BEN_DET					    NUMBER(3)
 NU_BENEFICIOS					    NUMBER(10,2)
 CD_BENEFICIO					    NUMBER(3)
 NU_IMP_MONETARIO				    NUMBER(11,2)
 NU_MES_PAGO					    NUMBER(2)
 ID_AGRUPADOR					    VARCHAR2(20)
 IN_CORRESP					    NUMBER(1)
 TIPOVIAL					    NUMBER(2)
 NOMVIAL					    VARCHAR2(255)
 CARRETERA					    VARCHAR2(255)
 CAMINO 					    VARCHAR2(255)
 NUMEXTNUM1					    NUMBER(5)
 NUMEXTNUM2					    NUMBER(5)
 NUMEXTALF1					    VARCHAR2(35)
 NUMINTNUM					    NUMBER(5)
 NUMINTALF					    VARCHAR2(35)
 TIPOASEN					    NUMBER(2)
 NOMASEN					    VARCHAR2(255)
 CP						    VARCHAR2(7)
 NOM_LOC					    VARCHAR2(255)
 CVE_LOC					    VARCHAR2(4)
 NOM_MUN					    VARCHAR2(255)
 CVE_MUN					    VARCHAR2(3)
 NOM_ENT					    VARCHAR2(255)
 CVE_ENT					    VARCHAR2(2)
 TIPOREF1					    NUMBER(2)
 NOMREF1					    VARCHAR2(255)
 TIPOREF2					    NUMBER(2)
 NOMREF2					    VARCHAR2(255)
 TIPOREF3					    NUMBER(2)
 NOMREF3					    VARCHAR2(255)
 DESCRUBIC					    VARCHAR2(255)
 AGEB						    VARCHAR2(4)
 CLAVE_MZNA					    VARCHAR2(3)
 LONGITUD					    NUMBER(11,6)
 LATITUD					    NUMBER(9,6)
 ID_UNICO					    NUMBER

-------
STEP 2
-------
# sed commands to delete the second column
# visual select
# s/^ //g
# s/ .*$//g

CVE_PAD
PERIODO
ID_REGISTRO
ID_HOGAR
ID_CUIS_PS
ID_CUIS_SEDESOL
FH_LEVANTAMIENTO
ID_PERSONA
NB_PRIMER_AP
NB_SEGUNDO_AP
NB_NOMBRE
FH_NACIMIENTO
CD_SEXO
CD_EDO_NAC
NB_CURP_ORI
IN_HUELLA
IN_IRIS
CD_EDO_CIVIL
CD_DEPENDENCIA
CD_INSTITUCION
CD_PROGRAMA
CD_INTRAPROGRAMA
NB_SUBPROGRAMA
CD_ENT_PAGO
CD_MUN_PAGO
CD_LOC_PAGO
CD_TP_BENEFICIO
IN_TITULAR
CD_PARENTESCO
CD_TP_BEN_DET
NU_BENEFICIOS
CD_BENEFICIO
NU_IMP_MONETARIO
NU_MES_PAGO
ID_AGRUPADOR
IN_CORRESP

TIPOVIAL
NOMVIAL
CARRETERA
CAMINO
NUMEXTNUM1
NUMEXTNUM2
NUMEXTALF1
NUMINTNUM
NUMINTALF
TIPOASEN
NOMASEN
CP
NOM_LOC
CVE_LOC
NOM_MUN
CVE_MUN
NOM_ENT
CVE_ENT
TIPOREF1
NOMREF1
TIPOREF2
NOMREF2
TIPOREF3
NOMREF3
DESCRUBIC
AGEB
CLAVE_MZNA
LONGITUD
LATITUD
ID_UNICO

------
STEP 3
------
# Knock out NULL values
#
# the following was generated with visual block copying and editing with pipes
  
SELECT COUNT(*) AS COUNT_NON_NULL_CVE_PAD FROM TU_BORRA_EXPORT_160610_S072 WHERE CVE_PAD IS NOT NULL;
SELECT COUNT(*) AS COUNT_NON_NULL_PERIODO FROM TU_BORRA_EXPORT_160610_S072 WHERE PERIODO IS NOT NULL;
SELECT COUNT(*) AS COUNT_NON_NULL_ID_REGISTRO FROM TU_BORRA_EXPORT_160610_S072 WHERE ID_REGISTRO IS NOT NULL;
SELECT COUNT(*) AS COUNT_NON_NULL_ID_HOGAR FROM TU_BORRA_EXPORT_160610_S072 WHERE ID_HOGAR IS NOT NULL;
SELECT COUNT(*) AS COUNT_NON_NULL_ID_CUIS_PS FROM TU_BORRA_EXPORT_160610_S072 WHERE ID_CUIS_PS IS NOT NULL;
SELECT COUNT(*) AS COUNT_NON_NULL_ID_CUIS_SEDESOL FROM TU_BORRA_EXPORT_160610_S072 WHERE ID_CUIS_SEDESOL IS NOT NULL;
SELECT COUNT(*) AS COUNT_NON_NULL_LEVANTAMIENTO FROM TU_BORRA_EXPORT_160610_S072 WHERE FH_LEVANTAMIENTO IS NOT NULL;
SELECT COUNT(*) AS COUNT_NON_NULL_ID_PERSONA FROM TU_BORRA_EXPORT_160610_S072 WHERE ID_PERSONA IS NOT NULL;
SELECT COUNT(*) AS COUNT_NON_NULL_NB_PRIMER_AP FROM TU_BORRA_EXPORT_160610_S072 WHERE NB_PRIMER_AP IS NOT NULL;
SELECT COUNT(*) AS COUNT_NON_NULL_NB_SEGUNDO_AP FROM TU_BORRA_EXPORT_160610_S072 WHERE NB_SEGUNDO_AP IS NOT NULL;
SELECT COUNT(*) AS COUNT_NON_NULL_NB_NOMBRE FROM TU_BORRA_EXPORT_160610_S072 WHERE NB_NOMBRE IS NOT NULL;
SELECT COUNT(*) AS COUNT_NON_NULL_FH_NACIMIENTO FROM TU_BORRA_EXPORT_160610_S072 WHERE FH_NACIMIENTO IS NOT NULL;
SELECT COUNT(*) AS COUNT_NON_NULL_CD_SEXO FROM TU_BORRA_EXPORT_160610_S072 WHERE CD_SEXO IS NOT NULL;
SELECT COUNT(*) AS COUNT_NON_NULL_CD_EDO_NAC FROM TU_BORRA_EXPORT_160610_S072 WHERE CD_EDO_NAC IS NOT NULL;
SELECT COUNT(*) AS COUNT_NON_NULL_NB_CURP_ORI FROM TU_BORRA_EXPORT_160610_S072 WHERE NB_CURP_ORI IS NOT NULL;
SELECT COUNT(*) AS COUNT_NON_NULL_IN_HUELLA FROM TU_BORRA_EXPORT_160610_S072 WHERE IN_HUELLA IS NOT NULL;
SELECT COUNT(*) AS COUNT_NON_NULL_IN_IRIS FROM TU_BORRA_EXPORT_160610_S072 WHERE IN_IRIS IS NOT NULL;
SELECT COUNT(*) AS COUNT_NON_NULL_CD_EDO_CIVIL FROM TU_BORRA_EXPORT_160610_S072 WHERE CD_EDO_CIVIL IS NOT NULL;
SELECT COUNT(*) AS COUNT_NON_NULL_CD_DEPENDENCIA FROM TU_BORRA_EXPORT_160610_S072 WHERE CD_DEPENDENCIA IS NOT NULL; 
SELECT COUNT(*) AS COUNT_NON_NULL_CD_INSTITUCION FROM TU_BORRA_EXPORT_160610_S072 WHERE CD_INSTITUCION IS NOT NULL;
SELECT COUNT(*) AS COUNT_NON_NULL_CD_PROGRAMA FROM TU_BORRA_EXPORT_160610_S072 WHERE CD_PROGRAMA IS NOT NULL;
SELECT COUNT(*) AS COUNT_NON_NULL_INTRA FROM TU_BORRA_EXPORT_160610_S072 WHERE CD_INTRAPROGRAMA IS NOT NULL;
SELECT COUNT(*) AS COUNT_NON_NULL_NB_SUBPROGRAMA FROM TU_BORRA_EXPORT_160610_S072 WHERE NB_SUBPROGRAMA IS NOT NULL;
SELECT COUNT(*) AS COUNT_NON_NULL_CD_ENT_PAGO FROM TU_BORRA_EXPORT_160610_S072 WHERE CD_ENT_PAGO IS NOT NULL;
SELECT COUNT(*) AS COUNT_NON_NULL_CD_MUN_PAGO FROM TU_BORRA_EXPORT_160610_S072 WHERE CD_MUN_PAGO IS NOT NULL;
SELECT COUNT(*) AS COUNT_NON_NULL_CD_LOC_PAGO FROM TU_BORRA_EXPORT_160610_S072 WHERE CD_LOC_PAGO IS NOT NULL;
SELECT COUNT(*) AS COUNT_NON_NULL_CD_TP_BENEFICIO FROM TU_BORRA_EXPORT_160610_S072 WHERE CD_TP_BENEFICIO IS NOT NULL;
SELECT COUNT(*) AS COUNT_NON_NULL_IN_TITULAR FROM TU_BORRA_EXPORT_160610_S072 WHERE IN_TITULAR IS NOT NULL;
SELECT COUNT(*) AS COUNT_NON_NULL_CD_PARENTESCO FROM TU_BORRA_EXPORT_160610_S072 WHERE CD_PARENTESCO IS NOT NULL;
SELECT COUNT(*) AS COUNT_NON_NULL_CD_TP_BEN_DET FROM TU_BORRA_EXPORT_160610_S072 WHERE CD_TP_BEN_DET IS NOT NULL;
SELECT COUNT(*) AS COUNT_NON_NULL_NU_BENEFICIOS FROM TU_BORRA_EXPORT_160610_S072 WHERE NU_BENEFICIOS IS NOT NULL;
SELECT COUNT(*) AS COUNT_NON_NULL_CD_BENEFICIO FROM TU_BORRA_EXPORT_160610_S072 WHERE CD_BENEFICIO IS NOT NULL;
SELECT COUNT(*) AS COUNT_NON_NULL_MONETARIO FROM TU_BORRA_EXPORT_160610_S072 WHERE NU_IMP_MONETARIO IS NOT NULL;
SELECT COUNT(*) AS COUNT_NON_NULL_NU_MES_PAGO FROM TU_BORRA_EXPORT_160610_S072 WHERE NU_MES_PAGO IS NOT NULL;
SELECT COUNT(*) AS COUNT_NON_NULL_ID_AGRUPADOR FROM TU_BORRA_EXPORT_160610_S072 WHERE ID_AGRUPADOR IS NOT NULL;
SELECT COUNT(*) AS COUNT_NON_NULL_IN_CORRESP FROM TU_BORRA_EXPORT_160610_S072 WHERE IN_CORRESP IS NOT NULL;
SELECT COUNT(*) AS COUNT_NON_NULL_TIPOVIAL FROM TU_BORRA_EXPORT_160610_S072 WHERE TIPOVIAL IS NOT NULL;
SELECT COUNT(*) AS COUNT_NON_NULL_NOMVIAL FROM TU_BORRA_EXPORT_160610_S072 WHERE NOMVIAL IS NOT NULL;
SELECT COUNT(*) AS COUNT_NON_NULL_CARRETERA FROM TU_BORRA_EXPORT_160610_S072 WHERE CARRETERA IS NOT NULL;
SELECT COUNT(*) AS COUNT_NON_NULL_CAMINO FROM TU_BORRA_EXPORT_160610_S072 WHERE CAMINO IS NOT NULL;
SELECT COUNT(*) AS COUNT_NON_NULL_NUMEXTNUM1 FROM TU_BORRA_EXPORT_160610_S072 WHERE NUMEXTNUM1 IS NOT NULL;
SELECT COUNT(*) AS COUNT_NON_NULL_NUMEXTNUM2 FROM TU_BORRA_EXPORT_160610_S072 WHERE NUMEXTNUM2 IS NOT NULL;
SELECT COUNT(*) AS COUNT_NON_NULL_NUMEXTALF1 FROM TU_BORRA_EXPORT_160610_S072 WHERE NUMEXTALF1 IS NOT NULL;
SELECT COUNT(*) AS COUNT_NON_NULL_NUMINTNUM FROM TU_BORRA_EXPORT_160610_S072 WHERE NUMINTNUM IS NOT NULL;
SELECT COUNT(*) AS COUNT_NON_NULL_NUMINTALF FROM TU_BORRA_EXPORT_160610_S072 WHERE NUMINTALF IS NOT NULL;
SELECT COUNT(*) AS COUNT_NON_NULL_TIPOASEN FROM TU_BORRA_EXPORT_160610_S072 WHERE TIPOASEN IS NOT NULL;
SELECT COUNT(*) AS COUNT_NON_NULL_NOMASEN FROM TU_BORRA_EXPORT_160610_S072 WHERE NOMASEN IS NOT NULL;
SELECT COUNT(*) AS COUNT_NON_NULL_CP FROM TU_BORRA_EXPORT_160610_S072 WHERE CP IS NOT NULL;
SELECT COUNT(*) AS COUNT_NON_NULL_NOM_LOC FROM TU_BORRA_EXPORT_160610_S072 WHERE NOM_LOC IS NOT NULL;
SELECT COUNT(*) AS COUNT_NON_NULL_CVE_LOC FROM TU_BORRA_EXPORT_160610_S072 WHERE CVE_LOC IS NOT NULL;
SELECT COUNT(*) AS COUNT_NON_NULL_NOM_MUN FROM TU_BORRA_EXPORT_160610_S072 WHERE NOM_MUN IS NOT NULL;
SELECT COUNT(*) AS COUNT_NON_NULL_CVE_MUN FROM TU_BORRA_EXPORT_160610_S072 WHERE CVE_MUN IS NOT NULL;
SELECT COUNT(*) AS COUNT_NON_NULL_NOM_ENT FROM TU_BORRA_EXPORT_160610_S072 WHERE NOM_ENT IS NOT NULL;
SELECT COUNT(*) AS COUNT_NON_NULL_CVE_ENT FROM TU_BORRA_EXPORT_160610_S072 WHERE CVE_ENT IS NOT NULL;
SELECT COUNT(*) AS COUNT_NON_NULL_TIPOREF1 FROM TU_BORRA_EXPORT_160610_S072 WHERE TIPOREF1 IS NOT NULL;
SELECT COUNT(*) AS COUNT_NON_NULL_NOMREF1 FROM TU_BORRA_EXPORT_160610_S072 WHERE NOMREF1 IS NOT NULL;
SELECT COUNT(*) AS COUNT_NON_NULL_TIPOREF2 FROM TU_BORRA_EXPORT_160610_S072 WHERE TIPOREF2 IS NOT NULL;
SELECT COUNT(*) AS COUNT_NON_NULL_NOMREF2 FROM TU_BORRA_EXPORT_160610_S072 WHERE NOMREF2 IS NOT NULL;
SELECT COUNT(*) AS COUNT_NON_NULL_TIPOREF3 FROM TU_BORRA_EXPORT_160610_S072 WHERE TIPOREF3 IS NOT NULL;
SELECT COUNT(*) AS COUNT_NON_NULL_NOMREF3 FROM TU_BORRA_EXPORT_160610_S072 WHERE NOMREF3 IS NOT NULL;
SELECT COUNT(*) AS COUNT_NON_NULL_DESCRUBIC FROM TU_BORRA_EXPORT_160610_S072 WHERE DESCRUBIC IS NOT NULL;
SELECT COUNT(*) AS COUNT_NON_NULL_AGEB FROM TU_BORRA_EXPORT_160610_S072 WHERE AGEB IS NOT NULL;
SELECT COUNT(*) AS COUNT_NON_NULL_CLAVE_MZNA FROM TU_BORRA_EXPORT_160610_S072 WHERE CLAVE_MZNA   
SELECT COUNT(*) AS COUNT_NON_NULL_LONGITUD FROM TU_BORRA_EXPORT_160610_S072 WHERE LONGITUD IS NOT NULL;
SELECT COUNT(*) AS COUNT_NON_NULL_LATITUD FROM TU_BORRA_EXPORT_160610_S072 WHERE LATITUD IS NOT NULL;
SELECT COUNT(*) AS COUNT_NON_NULL_ID_UNICO FROM TU_BORRA_EXPORT_160610_S072 WHERE ID_UNICO IS NOT NULL;


------
STEP 4
------
# Document the zeros and non-zeros, anything not marked as zero is assumed to contain data

CVE_PAD
PERIODO
ID_REGISTRO
ID_HOGAR
ID_CUIS_PS
ID_CUIS_SEDESOL
* FH_LEVANTAMIENTO
ID_PERSONA
NB_PRIMER_AP|0
NB_SEGUNDO_AP|0
NB_NOMBRE|0
FH_NACIMIENTO
CD_SEXO
CD_EDO_NAC
NB_CURP_ORI|0
IN_HUELLA|0
IN_IRIS|0
CD_EDO_CIVIL
CD_DEPENDENCIA
CD_INSTITUCION
CD_PROGRAMA
* CD_INTRAPROGRAMA
NB_SUBPROGRAMA
CD_ENT_PAGO
CD_MUN_PAGO
CD_LOC_PAGO
CD_TP_BENEFICIO
IN_TITULAR
CD_PARENTESCO
CD_TP_BEN_DET
NU_BENEFICIOS
CD_BENEFICIO
* NU_IMP_MONETARIO
NU_MES_PAGO
ID_AGRUPADOR|0
IN_CORRESP|0
TIPOVIAL|0
NOMVIAL|0
CARRETERA|0
CAMINO|0
NUMEXTNUM1|0
NUMEXTNUM2|0
NUMEXTALF1|0
NUMINTNUM|0
NUMINTALF|0
TIPOASEN|0
NOMASEN|0
CP|23626640
NOM_LOC|58802393
CVE_LOC|58802393
NOM_MUN|58802393
CVE_MUN|58802393
NOM_ENT|58802393
CVE_ENT|58802393
TIPOREF1 IS NOT NULL;
NOMREF1 IS NOT NULL;
TIPOREF2 IS NOT NULL;
NOMREF2 IS NOT NULL;
TIPOREF3 IS NOT NULL;
NOMREF3 IS NOT NULL;
DESCRUBIC IS NOT NULL;
AGEB IS NOT NULL;
CLAVE_MZNA|0
LONGITUD|0
LATITUD|0
ID_UNICO|58802393

------
STEP 5
------
# Select non-zero fields and export to disk

SET HEADING OFF;
SET FEEDBACK OFF;
SET ECHO OFF;
SET PAGESIZE 0;
SET TERMOUT OFF;
SET LINESIZE 354;
SET COLSEP ,;
SPOOL export.csv;
SELECT
CVE_PAD,
PERIODO,
ID_REGISTRO,
ID_HOGAR,
ID_CUIS_PS,
ID_CUIS_SEDESOL,
FH_LEVANTAMIENTO,
ID_PERSONA,
FH_NACIMIENTO,
CD_SEXO,
CD_EDO_NAC,
CD_EDO_CIVIL,
CD_DEPENDENCIA,
CD_INSTITUCION,
CD_PROGRAMA,
CD_INTRAPROGRAMA,
NB_SUBPROGRAMA,
CD_ENT_PAGO,
CD_MUN_PAGO,
CD_LOC_PAGO,
CD_TP_BENEFICIO,
IN_TITULAR,
CD_PARENTESCO,
CD_TP_BEN_DET,
NU_BENEFICIOS,
CD_BENEFICIO,
NU_IMP_MONETARIO,
NU_MES_PAGO,
CVE_LOC,
CVE_MUN,
CVE_ENT,
ID_UNICO
FROM TU_BORRA_EXPORT_160610_S072;
SPOOL OFF;

-------------------------------
N_CHARACTERS OF THOSE SELECTING:
---------------------------------
CVE_PAD|4
PERIODO|7
ID_REGISTRO|40
ID_HOGAR|30
ID_CUIS_PS|40
ID_CUIS_SEDESOL|40
FH_LEVANTAMIENTO|9
ID_PERSONA|40
FH_NACIMIENTO|9
CD_SEXO|1
CD_EDO_NAC|2
CD_EDO_CIVIL|2
CD_DEPENDENCIA|2
CD_INSTITUCION|5
CD_PROGRAMA|4
CD_INTRAPROGRAMA|2
NB_SUBPROGRAMA|60
CD_ENT_PAGO|2
CD_MUN_PAGO|3
CD_LOC_PAGO|4
CD_TP_BENEFICIO|3
IN_TITULAR|1
CD_PARENTESCO|2
CD_TP_BEN_DET|3
NU_BENEFICIOS|12
CD_BENEFICIO|3
NU_IMP_MONETARIO|13
NU_MES_PAGO|2
CVE_LOC|4
CVE_MUN|3
CVE_ENT|2
ID_UNICO|?

------------------
NOTES ON SETTINGS
------------------
https://docs.oracle.com/cd/B19306_01/server.102/b14357/ch6.htm
http://docs.oracle.com/database/121/SQPUG/ch_twelve040.htm#SQPUG079


-  "The default width of datatype columns is the width of the column in the
    database. The column width of a LONG, CLOB, NCLOB or XMLType defaults to the
    value of SET LONGCHUNKSIZE or SET LONG, whichever is the smaller."

    Example:

    SELECT CVE_PAD, PERIODO from TU_BORRA_EXPORT_160610_S072;

    Ok, so CVE_PAD is four characters so the header row truncates to four
    characters, but we can get the header later


 -  ON or OFF turns this display on or off. Turning feedback ON sets n to 1.
    Setting feedback to zero is equivalent to turning it OFF.

    SET FEEDBACK OFF also turns off the statement confirmation messages such as
    'Table created' and 'PL/SQL procedure successfully completed' that are
    displayed after successful SQL or PL/SQL statements.


-   SET ECHO ON/OFF
    Controls whether or not to echo commands in a script that is executed with @,
    @@ or START. ON displays the commands on screen. OFF suppresses the display.
    ECHO does not affect the display of commands you enter interactively or
    redirect to SQL*Plus from the operating system.
